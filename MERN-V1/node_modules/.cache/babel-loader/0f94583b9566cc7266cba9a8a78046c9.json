{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.observeElementRemoved = exports.offset = exports.getNumberValueOfStyle = void 0;\n\nvar checking_1 = require(\"./checking\");\n\nvar str_num_1 = require(\"./str-num\");\n/**\n * 获取 DOM 元素数值类型的样式并返回取整后的数值\n * @param elem  DOM 元素\n * @param attr  CSS 属性\n */\n\n\nfunction getNumberValueOfStyle(elem, attr) {\n  var value = window.getComputedStyle(elem)[attr];\n\n  if (checking_1.isString(value)) {\n    // 匹配字符串的数字字符\n    var numberValue = value.match(/\\d+/);\n\n    if (numberValue) {\n      return str_num_1.pInt(numberValue[0]);\n    }\n  }\n}\n\nexports.getNumberValueOfStyle = getNumberValueOfStyle;\n/**\n * 获取 DOM 元素距离页面的 top、left 值\n * @param elem  DOM 元素\n */\n\nfunction offset(elem) {\n  var bounding = elem.getBoundingClientRect();\n  return {\n    left: window.pageXOffset + bounding.left,\n    top: window.pageYOffset + bounding.top\n  };\n}\n\nexports.offset = offset;\n/**\n * 不管是 MutationObserver 还是 DOMNodeRemoved，\n * 当监听某个具体的元素时，如果祖先节点被删除了，并不会触发该元素被移除的事件，\n * 所以要监听整个文档，每次移除事件都得递归遍历要监听的元素是否被删除。\n */\n\nexports.observeElementRemoved = function () {\n  var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;\n\n  var checkElementRemoved = function (node, element) {\n    if (node === element) {\n      return true;\n    }\n\n    if (checking_1.isElement(node)) {\n      var children = node.children;\n      var length_1 = children.length;\n\n      while (length_1--) {\n        if (checkElementRemoved(children[length_1], element)) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  };\n\n  var useMutation = function (element, callback) {\n    var observer = new MutationObserver(function (mutations, observer) {\n      var i = mutations.length;\n\n      while (i--) {\n        var removeNodes = mutations[i].removedNodes;\n        var j = removeNodes.length;\n\n        while (j--) {\n          if (checkElementRemoved(removeNodes[j], element)) {\n            observer.disconnect();\n            return callback();\n          }\n        }\n      }\n    });\n    observer.observe(document, {\n      childList: true,\n      subtree: true\n    });\n  };\n\n  var useDOMNodeRemoved = function (element, callback) {\n    var DOMNodeRemoved = function (e) {\n      if (checkElementRemoved(e.target, element)) {\n        document.removeEventListener('DOMNodeRemoved', DOMNodeRemoved);\n        callback();\n      }\n    };\n\n    document.addEventListener('DOMNodeRemoved', DOMNodeRemoved);\n  };\n\n  return MutationObserver ? useMutation : useDOMNodeRemoved;\n}();","map":{"version":3,"names":["Object","defineProperty","exports","value","observeElementRemoved","offset","getNumberValueOfStyle","checking_1","require","str_num_1","elem","attr","window","getComputedStyle","isString","numberValue","match","pInt","bounding","getBoundingClientRect","left","pageXOffset","top","pageYOffset","MutationObserver","WebKitMutationObserver","checkElementRemoved","node","element","isElement","children","length_1","length","useMutation","callback","observer","mutations","i","removeNodes","removedNodes","j","disconnect","observe","document","childList","subtree","useDOMNodeRemoved","DOMNodeRemoved","e","target","removeEventListener","addEventListener"],"sources":["/Users/roy/Desktop/drajm-site/node_modules/jparticles/lib/utils/dom.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.observeElementRemoved = exports.offset = exports.getNumberValueOfStyle = void 0;\nvar checking_1 = require(\"./checking\");\nvar str_num_1 = require(\"./str-num\");\n/**\n * 获取 DOM 元素数值类型的样式并返回取整后的数值\n * @param elem  DOM 元素\n * @param attr  CSS 属性\n */\nfunction getNumberValueOfStyle(elem, attr) {\n    var value = window.getComputedStyle(elem)[attr];\n    if (checking_1.isString(value)) {\n        // 匹配字符串的数字字符\n        var numberValue = value.match(/\\d+/);\n        if (numberValue) {\n            return str_num_1.pInt(numberValue[0]);\n        }\n    }\n}\nexports.getNumberValueOfStyle = getNumberValueOfStyle;\n/**\n * 获取 DOM 元素距离页面的 top、left 值\n * @param elem  DOM 元素\n */\nfunction offset(elem) {\n    var bounding = elem.getBoundingClientRect();\n    return {\n        left: window.pageXOffset + bounding.left,\n        top: window.pageYOffset + bounding.top,\n    };\n}\nexports.offset = offset;\n/**\n * 不管是 MutationObserver 还是 DOMNodeRemoved，\n * 当监听某个具体的元素时，如果祖先节点被删除了，并不会触发该元素被移除的事件，\n * 所以要监听整个文档，每次移除事件都得递归遍历要监听的元素是否被删除。\n */\nexports.observeElementRemoved = (function () {\n    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;\n    var checkElementRemoved = function (node, element) {\n        if (node === element) {\n            return true;\n        }\n        if (checking_1.isElement(node)) {\n            var children = node.children;\n            var length_1 = children.length;\n            while (length_1--) {\n                if (checkElementRemoved(children[length_1], element)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    var useMutation = function (element, callback) {\n        var observer = new MutationObserver(function (mutations, observer) {\n            var i = mutations.length;\n            while (i--) {\n                var removeNodes = mutations[i].removedNodes;\n                var j = removeNodes.length;\n                while (j--) {\n                    if (checkElementRemoved(removeNodes[j], element)) {\n                        observer.disconnect();\n                        return callback();\n                    }\n                }\n            }\n        });\n        observer.observe(document, {\n            childList: true,\n            subtree: true,\n        });\n    };\n    var useDOMNodeRemoved = function (element, callback) {\n        var DOMNodeRemoved = function (e) {\n            if (checkElementRemoved(e.target, element)) {\n                document.removeEventListener('DOMNodeRemoved', DOMNodeRemoved);\n                callback();\n            }\n        };\n        document.addEventListener('DOMNodeRemoved', DOMNodeRemoved);\n    };\n    return MutationObserver ? useMutation : useDOMNodeRemoved;\n})();\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}