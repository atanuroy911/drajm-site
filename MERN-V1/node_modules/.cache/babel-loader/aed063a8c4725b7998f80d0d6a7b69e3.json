{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.loadImage = exports.merge = void 0;\n\nvar checking_1 = require(\"./checking\");\n/**\n * 深拷贝，浅拷贝请使用 Object.assign 或 ECMAScript 扩展运算符\n * 1、API 参考 jQuery 深拷贝 https://api.jquery.com/jQuery.extend/#jQuery-extend-deep-target-object1-objectN\n * 2、数组合并采用替换方式，如\n *   merge({ a: [1, 2, 3] }, { a: [9, 8] }) => { a: [9, 8, 3] }\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\nfunction merge() {\n  var objects = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    objects[_i] = arguments[_i];\n  }\n\n  var length = objects.length;\n  var target = objects[0] || {};\n\n  for (var i = 0; i < length; i++) {\n    for (var prop in objects[i]) {\n      var value = objects[i][prop];\n      var copyIsArray = Array.isArray(value);\n\n      if (copyIsArray || checking_1.isPlainObject(value)) {\n        var src = target[prop];\n\n        if (copyIsArray) {\n          src = Array.isArray(src) ? src : [];\n        } else {\n          src = checking_1.isPlainObject(src) ? src : {};\n        }\n\n        target[prop] = merge(src, value);\n      } else {\n        target[prop] = value;\n      }\n    }\n  }\n\n  return target;\n}\n\nexports.merge = merge;\n/**\n * 加载图像\n *  - 缓存机制\n *  - 错误重试机制\n *\n * @param url 图像地址\n * @param successCallback 加载成功的回调函数\n * @param errorCallback 加载失败的回调函数\n */\n\nfunction loadImage(url, successCallback, errorCallback) {\n  if (loadImage.cachedImages[url]) {\n    successCallback(loadImage.cachedImages[url]);\n    return;\n  }\n\n  var times = 0;\n\n  (function request() {\n    var image = new Image();\n    image.addEventListener('load', function () {\n      loadImage.cachedImages[url] = image;\n      successCallback(image);\n    });\n    image.addEventListener('error', function (e) {\n      times++;\n      errorCallback === null || errorCallback === void 0 ? void 0 : errorCallback(e, times);\n\n      if (times <= 3) {\n        request();\n      }\n    });\n    image.crossOrigin = 'Anonymous';\n    image.src = url;\n  })();\n}\n\nexports.loadImage = loadImage;\nloadImage.cachedImages = {};","map":{"version":3,"names":["Object","defineProperty","exports","value","loadImage","merge","checking_1","require","objects","_i","arguments","length","target","i","prop","copyIsArray","Array","isArray","isPlainObject","src","url","successCallback","errorCallback","cachedImages","times","request","image","Image","addEventListener","e","crossOrigin"],"sources":["/Users/roy/Desktop/drajm-site/node_modules/jparticles/lib/utils/misc.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.loadImage = exports.merge = void 0;\nvar checking_1 = require(\"./checking\");\n/**\n * 深拷贝，浅拷贝请使用 Object.assign 或 ECMAScript 扩展运算符\n * 1、API 参考 jQuery 深拷贝 https://api.jquery.com/jQuery.extend/#jQuery-extend-deep-target-object1-objectN\n * 2、数组合并采用替换方式，如\n *   merge({ a: [1, 2, 3] }, { a: [9, 8] }) => { a: [9, 8, 3] }\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction merge() {\n    var objects = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        objects[_i] = arguments[_i];\n    }\n    var length = objects.length;\n    var target = objects[0] || {};\n    for (var i = 0; i < length; i++) {\n        for (var prop in objects[i]) {\n            var value = objects[i][prop];\n            var copyIsArray = Array.isArray(value);\n            if (copyIsArray || checking_1.isPlainObject(value)) {\n                var src = target[prop];\n                if (copyIsArray) {\n                    src = Array.isArray(src) ? src : [];\n                }\n                else {\n                    src = checking_1.isPlainObject(src) ? src : {};\n                }\n                target[prop] = merge(src, value);\n            }\n            else {\n                target[prop] = value;\n            }\n        }\n    }\n    return target;\n}\nexports.merge = merge;\n/**\n * 加载图像\n *  - 缓存机制\n *  - 错误重试机制\n *\n * @param url 图像地址\n * @param successCallback 加载成功的回调函数\n * @param errorCallback 加载失败的回调函数\n */\nfunction loadImage(url, successCallback, errorCallback) {\n    if (loadImage.cachedImages[url]) {\n        successCallback(loadImage.cachedImages[url]);\n        return;\n    }\n    var times = 0;\n    (function request() {\n        var image = new Image();\n        image.addEventListener('load', function () {\n            loadImage.cachedImages[url] = image;\n            successCallback(image);\n        });\n        image.addEventListener('error', function (e) {\n            times++;\n            errorCallback === null || errorCallback === void 0 ? void 0 : errorCallback(e, times);\n            if (times <= 3) {\n                request();\n            }\n        });\n        image.crossOrigin = 'Anonymous';\n        image.src = url;\n    })();\n}\nexports.loadImage = loadImage;\nloadImage.cachedImages = {};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}